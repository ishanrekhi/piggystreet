<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PiggyStreet ‚Äî 7-Day News Stock Game</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles.css">
  <style>
    .load-warning{
      position:fixed;left:0;right:0;bottom:0;z-index:9999;
      background:#fee;border-top:1px solid #f99;color:#900;
      font-family:system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      padding:12px 14px;font-size:14px
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <header class="hero">
        <img class="corner-logo" src="./Green Black Modern Finance Logo (2).png" alt="PiggyStreet logo"/>
        <div class="status">
          <span class="badge">üí∞ Coins: <span id="coins">0</span></span>
          <span class="badge">üîç<span id="inv-peek">0</span> ‚ú®<span id="inv-double">0</span> üõ°Ô∏è<span id="inv-ins">0</span></span>
          <span class="badge">üìÖ Day <span id="day">0</span>/7</span>
        </div>
      </header>

      <section id="screen-menu" class="hero-body">
        <div id="avatar" class="logo hidden"></div>
        <div class="titles main-titles">
          <h1 class="title">PiggyStreet</h1>
          <p class="subtitle">A 7-Day Stock News Challenge</p>
          <a href="https://piggystreet.fun" class="site-link" target="_blank" rel="noopener">Our Website</a>
        </div>

        <div class="cta-row">
          <button id="btn-shop">Penny Upgrades</button>
          <button id="btn-tutorial">Start Tutorial</button>
          <button id="btn-start" class="primary xl">Start Game</button>
        </div>

        <div class="mini-links">
          <button id="btn-change-class" class="text-link">Change class code</button>
        </div>

        <div class="muted footnote">Your coins & unlocks save on this device. No sign-in needed.</div>
      </section>

      <section id="screen-shop" class="hidden">
        <!-- Top label only (no emojis) -->
        <div class="row shop-title" style="justify-content:space-between;margin-bottom:8px">
          <strong>Penny Upgrades</strong>
        </div>

        <div class="grid">
          <div class="panel">
            <div class="row" style="justify-content:space-between">
              <strong>Looks (permanent)</strong>
              <span class="muted">Equip after buying</span>
            </div>
            <div id="shop-custom" class="shop-grid"></div>
          </div>

          <div class="panel">
            <div class="row" style="justify-content:space-between">
              <strong>Boosts (consumable)</strong>
              <span class="muted">Use during a day</span>
            </div>
            <div id="shop-boosts" class="shop-grid"></div>
          </div>
        </div>

        <!-- Back moved to bottom-right -->
        <div class="footer shop-footer">
          <button id="btn-shop-back" class="sm">Back</button>
        </div>
      </section>

      <!-- TUTORIAL -->
      <section id="screen-tutorial" class="hidden">
        <ol class="grid">
          <li class="panel">
            <strong>1) How the game works</strong>
            <div class="muted" style="margin-top:6px">
              ‚Ä¢ You have <span class="kbd">$1,000</span> starting cash for 7 days.<br/>
              ‚Ä¢ Each day shows <em>three</em> companies with a headline.<br/>
              ‚Ä¢ Buy or sell shares any time <em>before</em> ending the day.<br/>
              ‚Ä¢ After you end the day, prices move based on the headline‚Äôs ‚Äútilt‚Äù.<br/>
              ‚Ä¢ Goal: Finish with the highest portfolio value.
            </div>
          </li>
          <li class="panel">
            <strong>2) Reading headlines ‚Üí expectations</strong>
            <div class="muted" style="margin-top:6px">Prices reflect what people expect‚Ä¶ surprises move prices.</div>
          </li>
          <li class="panel">
            <strong>3) Sectors & drivers</strong>
            <div class="muted" style="margin-top:6px">
              ‚Ä¢ <b>Tech</b> cares about growth/margins/regulation.<br/>
              ‚Ä¢ <b>Financials</b> like higher rates.<br/>
              ‚Ä¢ <b>Energy</b> rises with higher oil prices.
            </div>
          </li>
          <li class="panel">
            <strong>4) Boosts</strong>
            <div class="muted" style="margin-top:6px">üîç Peek, ‚ú® Double, üõ°Ô∏è Insurance.</div>
          </li>
        </ol>

        <div class="panel">
          <div style="font-weight:700">Quick Check #1</div>
          <div class="muted">‚ÄúEarnings beat; guidance raised.‚Äù Most likely?</div>
          <div class="row" style="margin-top:6px">
            <button class="choice" data-q="1" data-a="good">Price tilts up</button>
            <button class="choice" data-q="1" data-a="bad">Price tilts down</button>
          </div>
          <div id="quiz-fb-1" class="muted" style="margin-top:6px"></div>
        </div>

        <div class="panel">
          <div style="font-weight:700">Quick Check #2</div>
          <div class="muted">Oil spikes higher ‚Äî which sector benefits most?</div>
          <div class="row" style="margin-top:6px">
            <button class="choice" data-q="2" data-a="Tech">Tech</button>
            <button class="choice" data-q="2" data-a="Energy">Energy</button>
            <button class="choice" data-q="2" data-a="Financials">Financials</button>
          </div>
          <div id="quiz-fb-2" class="muted" style="margin-top:6px"></div>
        </div>

        <div class="footer">
          <button id="btn-menu" class="sm">Back</button>
          <button id="btn-tutorial-finish" class="primary">Finish</button>
        </div>
      </section>

      <section id="screen-game" class="hidden">
        <div class="grid">
          <!-- Left: Portfolio -->
          <div class="panel">
            <div class="row" style="justify-content:space-between">
              <strong>üìä Portfolio</strong>
              <span class="pill">üíµ Cash: <span id="cash-value">$1,000</span></span>
            </div>
            <div id="holdings-list" class="muted" style="margin-top:8px"></div>
            <div class="row" style="justify-content:space-between;margin-top:8px">
              <span>Total positions value</span>
              <strong id="positions-value">$0</strong>
            </div>
            <div class="row" style="justify-content:space-between;margin-top:6px">
              <span>Overall P/L</span>
              <strong id="pnl-total">0.00%</strong>
            </div>
            <div class="progress"><div id="progress-bar"></div></div>
          </div>

          <!-- Right: Round Info -->
          <div class="panel round-info">
            <div class="row" style="justify-content:space-between">
              <strong>Round</strong>
              <span class="pill">üìÖ Day <span id="day2">1</span> of 7</span>
            </div>
            <div class="coach" style="margin-top:10px">
              <div class="who">üê∑</div>
              <div class="bubble" id="coach-bubble">Headlines tilt odds, not guarantees. Let‚Äôs learn by watching what happens!</div>
            </div>
          </div>

          <!-- Full width: Stocks -->
          <div id="panel-stocks" class="panel">
            <div class="row" style="justify-content:space-between">
              <strong>Stocks</strong>
            </div>

            <div id="stocks" class="stocks"></div>
          </div>
        </div>
      </section>

      <section id="screen-results" class="hidden">
        <h2>Final Results</h2>
        <div class="panel">
          <div class="row" style="justify-content:space-between"><div>Final value</div><div id="final-value"><strong>$10,000</strong></div></div>
          <div class="row" style="justify-content:space-between"><div>Total return</div><div id="final-ret"><strong>0.00%</strong></div></div>
        </div>
        <div id="final-expl" class="panel" style="margin-top:10px"></div>
        <div class="footer"><button id="btn-play-again" class="primary">Play Again</button></div>
      </section>

      <div id="toast" class="toast hidden"></div>
      <div id="confetti" class="confetti"></div>
    </div>
  </div>

  <!-- Class Code Modal -->
  <div id="classcode-modal" class="modal hidden" aria-hidden="true" role="dialog" aria-labelledby="cc-title" aria-modal="true">
    <div class="overlay"></div>
    <div class="modal-card" role="document">
      <h3 id="cc-title">Enter Class Code</h3>
      <p class="muted">Ask your teacher for today‚Äôs class code.</p>
      <input id="cc-input" type="text" placeholder="e.g., AB-CDEFG-29HI" autocomplete="off" />
      <div id="cc-error" class="error hidden">That code doesn‚Äôt look right. Try again.</div>
      <div class="row" style="justify-content:flex-end;margin-top:12px">
        <button id="cc-cancel" class="sm">Cancel</button>
        <button id="cc-submit" class="primary">Submit</button>
      </div>
    </div>
  </div>

  <script type="module">
    (async ()=>{
      const candidates = [
        './main.js',
        '/src/main.js'
      ];
      const v = location.search.includes('dev') ? '?dev=' + Date.now() : '';
      let lastErr = null;
      for (const p of candidates) {
        try { await import(p + v); console.log('[PiggyStreet] Loaded', p); return; }
        catch (e) { lastErr = e; console.warn('[PiggyStreet] Failed loading', p, e?.message || e); }
      }
      const warn = document.createElement('div');
      warn.className = 'load-warning';
      warn.textContent = 'PiggyStreet: could not load main.js. If using a bundler, build to /public (keeping relative imports) or configure the server to expose /src.';
      document.body.appendChild(warn);
      throw lastErr;
    })();
  </script>
</body>
</html>
